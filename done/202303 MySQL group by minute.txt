
SELECT
  SUM(donation_amount) AS total_donation_amount,
  EXTRACT(YEAR from timestamp) AS year,
  EXTRACT(MONTH from timestamp) AS month,
  EXTRACT(DAY from timestamp) AS day,
  EXTRACT(HOUR from timestamp) AS hour,
  EXTRACT(MINUTE from timestamp) AS minute
FROM `iro_option_price_items`
WHERE `timestamp` > '2012-12-07 10:00:00'
AND `donation_type` = 'em1'
GROUP BY year, month, day, hour, minute;



SELECT
  putCall, last,
  EXTRACT(YEAR from timestamp) AS year,
  EXTRACT(MONTH from timestamp) AS month,
  EXTRACT(DAY from timestamp) AS day,
  EXTRACT(HOUR from timestamp) AS hour,
  EXTRACT(MINUTE from timestamp) AS minute
FROM `iro_option_price_items`
WHERE `symbol` = 'GME_021023P20.5'
GROUP BY year, month, day, hour, minute;




SELECT   last, FLOOR(UNIX_TIMESTAMP(timestamp)/(15 * 60)) AS timekey
FROM     iro_option_price_items
WHERE `symbol` = 'GME_021023P20.5'
GROUP BY last, timekey;



SELECT   last, FROM_UNIXTIME(FLOOR(UNIX_TIMESTAMP(timestamp)/(15 * 60))) as updated_at, FLOOR(UNIX_TIMESTAMP(timestamp)/(15 * 60)) AS timekey
FROM     iro_option_price_items
WHERE `symbol` = 'GME_021023P20.5'
GROUP BY last, updated_at, timekey
order by updated_at desc;



SELECT   bid, ask,   date_format(timestamp, '%Y-%m-%d %h:%i') as seen_at, FLOOR(UNIX_TIMESTAMP(timestamp)/(15 * 60)) AS timekey
FROM     iro_option_price_items
WHERE `symbol` = 'GME_021023P20.5'
GROUP BY bid, ask, seen_at, timekey
order by seen_at asc;

